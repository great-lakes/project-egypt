<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Generators Test</title>
</head>

<body>
    <input id="path-input" placeholder="path" />
    <button id="add-button">Add</button>
    <script> // The contents between these script tags will be used for reference for adding and testing generators to site
        var globalGenerators = [];
        var globalPath = "";
        
        function appendCompleted(generatorObj){
            console.log("after append");

            // local storage functionality
            var generatorPathArr = JSON.parse(localStorage.getItem("generatorPathArr"))
            if (!generatorPathArr) {
                generatorPathArr = []
            }
            generatorPathArr.push(globalPath)
            localStorage.setItem("generatorPathArr", JSON.stringify(generatorPathArr));
            
            var storedNames = JSON.parse(localStorage.getItem("generatorPathArr"));
            console.log(storedNames);
        }

        function __testAndAppend__(generatorObj) {
            // TODO: verify object shape

            var s = globalGenerators.find(generator => generator.name === generatorObj.name);

            if (s) { 
                alert("Already exists");
                return;
            }
            
            generatorObj.path = globalPath;
            globalGenerators.push(generatorObj);
            console.log("generator added");
            
            appendCompleted(generatorObj);
        }

        document.querySelector('#add-button').addEventListener('click', function () {
            const path = document.querySelector('#path-input').value
            var s = document.createElement("script");
            s.src = path;
            // store path to append to generatorObj
            globalPath = path.trim()
            console.log("before append");
            document.body.appendChild(s)
        })

    </script>

</body>

</html>
